// =====================================================================================
// 
//       Filename:  main.cc
// 
//    Description:  计算指定字符串的crc16-ccitt值
// 
//        Version:  1.0
//        Created:  07/13/2009 04:28:39 PM
//       Revision:  none
//       Compiler:  g++
// 
//         Author:  Wang Xiaofeng (xfun68), xfun68@gmail.com
//        Company:  Linekong
// 
// =====================================================================================

#include <stdio.h>
#include <inttypes.h>
#include "SysAlgorithmCRC.h"

int main(int argc, char* argv[])
{
    uint8_t data[] = {0x00, 0x54, 0x10, 0x00, 0x30, 0x00, 0x00, 0x01, 0x00, 0x00, 0x1C, 0x7A, 0x00, 0x00, 0x00, 0x01, 0x74, 0x68, 0x75, 0x6E, 0x64, 0x65, 0x72, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x74, 0x65, 0x73, 0x74, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};
    // uint8_t data[] = {50, 45, 57, 78};
    // uint8_t data[] = {0x00, 0x54, 0x10, 0x00, 0x30, 0x00, 0x00, 0x01, 0x00, 0x00, 0x1F, 0x8B};
    // uint8_t data[] = {0x10,0x20};

    uint16_t crc = 0;
    int32_t data_len = 0;

    data_len = sizeof(data)/sizeof(int8_t);
    printf("data len is: %d\n", data_len);
    printf("data is:\n");

    for (int32_t i = 0; i < data_len; ++i) {
        if ((i > 0) && ((i % 16) == 0)) {
            printf("\n");
        }

        printf("0x%02x ", data[i]);
    }
    printf("\n");

    if (1 == SysAlgorithmCRC::compute(data, data_len, 0xffff, &crc)) {
        printf("crc is: 0x%04x %u\n", crc, crc);
    } else {
        printf("can not calculate crc\n");
    }

    return 0;
}

